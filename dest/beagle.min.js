var Beagle;!function(){"use strict";function a(){return void 0===window.localStorage?!1:!0}function b(a,b){g(n[a],function(a){a(b)})}function c(a){var b=a;return b=b.replace(/\s/g,""),b=b.toLowerCase()}function d(a){var b={};return g(a,function(a){b[a]=a}),b}function e(a,b){var c={};for(var d in a)c[d]=a[d];for(var d in b)c[d]=b[d];return c}function f(){var a=Date.now(),b=Math.floor(Math.random()*a-(a+1e3)+(a+1e3));return b}function g(a,b){for(var c=a.length;c--;)b(a[c],c)}var h={},i={nolocalstorage:"your browser doesn't support localstorage",schemaUndefined:"you have to defined a schema: Beagle.schema(schemaname:string, schemafields:array)",schemaNameEmpty:"you have to define a name for your schema",collectionNameUndefined:"collection name dont exist",collectionNotExist:"Collection dont exist",indexUndefined:"Index is undefinded",notInSchema:"attribute not in schema define"},j=function(){if(!a())throw i.nolocalstorage;var b={schema:function(a,b){if(void 0!==a&&"string"==typeof a&&void 0!==b&&void 0!==b[0]){var d=a,e=b;if(0===d.length)throw i.schemaNameEmpty;return d=c(d),m().schema(d,e)}throw i.schemaUndefined}};return b=e(b,k()),b=e(b,o())},k=function(){function a(a){return void 0!==a&&"string"==typeof a&&p().existCollection(a)===!0?!0:!1}function c(a,b){var c=d(h[a]);for(var e in b)if(void 0===c[e])return!1;return!0}function e(a,b){var c=a;for(var d in b)c[d]instanceof Array&&c[d].push(b[d]);return c}function j(a,b){var c=a;for(var d in b)if(c[d]instanceof Array){var e=c[d].indexOf(b[d]);e>-1&&c[d].splice(e,1)}return c}function k(a,b){var c=a;for(var d in b)c[d]=b[d];return c}function m(a,b){return a!==b?!0:!1}function n(a,b){return a===b?!0:!1}return{insert:function(c,d){if(!a(c))throw i.collectionNameUndefined;var e=h[c],j={index:f()};return g(e,function(a){j[a]=d[a]}),p().addModel(c,j),b("add",j),j},removeByIndex:function(c,d){if(!a(c))throw i.collectionNameUndefined;var e,f=p().getCollection(c);void 0!==f&&(e=f[d],delete f[d],p().save(c,f),b("remove",e))},findByIndex:function(b,c){if(void 0===c)throw i.indexUndefined;if(!a(b))throw i.collectionNameUndefined;var d=p().getCollection(b);return d[c]},findIndex:function(a,b){var d,e;for(var d in b)d=d,e=b[d];var f=p().getCollection(a);if(!c(a,e))throw i.notInSchema;var g=[];for(var h in e)g.push(h),g.push(e[h]);var j=[];for(var k in f){var l=!1;switch(d){case"is":l=n(f[k][g[0]],g[1]);break;case"isNot":l=m(f[k][g[0]],g[1])}l&&j.push(k)}return j},find:function(a,b){var c=this.findIndex(a,b),d=p().getCollection(a),e=[];return g(c,function(a){e.push(d[a])}),l(e)},findAll:function(b){if(!a(b))throw i.collectionNameUndefined;var c=[],d=p().getCollection(b);for(var e in d)c.push(d[e]);return l(c)},remove:function(a,b){var c=this.findIndex(a,b),d=p().getCollection(a),e=this,f=[];return g(c,function(b){f.push(d[b]),e.removeByIndex(a,b)}),l(f)},update:function(a,b,c){var d=this.findIndex(a,b),e=this,f=[];g(d,function(b){e.updateByIndex(a,b,c)});var h=p().getCollection(a);return g(d,function(a){f.push(h[a])}),l(f)},updateByIndex:function(d,f,g){if(!a(d))throw i.collectionNameUndefined;if(void 0===f)throw i.indexUndefined;var h=p().getCollection(d)[f];for(var l in g){var m=g[l];if(!c(d,g[l]))throw i.notInSchema;var h;switch(l){case"set":h=k(h,m);break;case"push":h=e(h,m);break;case"pull":h=j(h,m)}}var n=p().getCollection(d);n[h.index]=h,p().save(d,n),b("update",updated)}}},l=function(a){var a=a;return{count:function(){return a.length},fetch:function(){return a},where:function(){},sort:function(){}}},m=function(){return{schema:function(a,b){return h[a]=b,p().createCollection(a)?(h[a]=b,!0):!1}}},n={update:[],remove:[],add:[]},o=function(){return{on:function(a,b){n[a].push(b)}}},p=function(){return{addModel:function(a,b){if(!this.existCollection(a))throw i.collectionNotExist;var c=this.getCollection(a);c[b.index]=b,this.save(a,c)},save:function(a,b){localStorage.setItem(a,JSON.stringify(b))},existCollection:function(a){return null!==localStorage.getItem(a)?!0:!1},createCollection:function(a){return this.existCollection(a)?!1:(localStorage.setItem(a,JSON.stringify({})),!0)},getCollection:function(a){return this.existCollection(a)?JSON.parse(localStorage.getItem(a)):void 0}}};Beagle=new j}();
//# sourceMappingURL=beagle.min.js.map